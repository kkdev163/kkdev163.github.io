<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Wechaty-微信群机器人-读经助手 | kkdev163</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kkdev163.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kkdev163.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kkdev163.github.io/blog/wechaty-bible-robot"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Wechaty-微信群机器人-读经助手 | kkdev163"><meta data-rh="true" name="description" content="本文首发于 Wechaty 社区"><meta data-rh="true" property="og:description" content="本文首发于 Wechaty 社区"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2021-05-02T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://kkdev163.github.io"><meta data-rh="true" property="article:tag" content="wechaty、robot"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kkdev163.github.io/blog/wechaty-bible-robot"><link data-rh="true" rel="alternate" href="https://kkdev163.github.io/blog/wechaty-bible-robot" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://kkdev163.github.io/blog/wechaty-bible-robot" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="kkdev163 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="kkdev163 Atom Feed">



<link rel="alternate" type="application/rss+xml" href="/presentation/rss.xml" title="kkdev163 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/presentation/atom.xml" title="kkdev163 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.8dcef9a5.css">
<link rel="preload" href="/assets/js/runtime~main.59883482.js" as="script">
<link rel="preload" href="/assets/js/main.03c6f4a0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">kkdev163</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">文章</a><a class="navbar__item navbar__link" href="/presentation">演讲</a><a class="navbar__item navbar__link" href="/about">关于我</a><a href="https://github.com/kkdev163" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">最近文章</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/inner-glance-of-padlocal">Wechaty-puppet-padlocal 实现初探</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/wechaty-bible-robot">Wechaty-微信群机器人-读经助手</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/elasticsearch-basic">ES(ElasticSearch) 搜索基本概念简介</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/lighthouse">Lighthous 测试内幕</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/wapm-storage">前端性能监控平台-存储与计算架构展望</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/sentry-sshfs">Sentry平台-为Docker Swarm集群添加SSHFS分布式文件存储</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="本文首发于 Wechaty 社区"><header><h1 class="title_f1Hy" itemprop="headline">Wechaty-微信群机器人-读经助手</h1><div class="container_mt6G margin-vert--md"><time datetime="2021-05-02T00:00:00.000Z" itemprop="datePublished">2021年5月2日</time> · <!-- -->阅读需 12 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://kkdev163.github.io" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/34838245?v=4" alt="kkdev163" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://kkdev163.github.io" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">kkdev163</span></a></div><small class="avatar__subtitle" itemprop="description">Web 全栈开发工程师@NetEase</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><blockquote><p>本文首发于 <a href="https://wechaty.js.org/2021/05/02/wechaty-bible-chatbot/" target="_blank" rel="noopener noreferrer">Wechaty 社区</a></p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="一前言">一、前言<a href="#一前言" class="hash-link" aria-label="一、前言的直接链接" title="一、前言的直接链接">​</a></h2><p>笔者将从 开发意图、产品功能特性、技术方案、心得体会 等方面回顾总结 微信群机器人-读经助手 的产品开发历程，希望对其他开发者有所帮助。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="二开发意图">二、开发意图<a href="#二开发意图" class="hash-link" aria-label="二、开发意图的直接链接" title="二、开发意图的直接链接">​</a></h2><p>笔者是一名基督徒微信群的成员，群里需要人工每天定时发送「文章」链接，并统计群成员「已读」人数。最早我们采取的方案是人工定时发送，群成员到 在线协同工具 如「石墨文档」手动填写「已读」。该方案虽然节省了统计人数的工作量，但依然有几个缺点：</p><ul><li>群成员年龄分布广，包含 60、70 岁成员，让他们跳转至第三方应用手动填写，操作成本高，导致打卡率低。</li><li>在群里直接文字打卡，可激励其他成员，而跳转至第三方应用打卡，就减弱了这个互动性。</li><li>每天人工定时发送，长期来看对发送人员是个不小的挑战。</li></ul><p>所以希望能够开发一个 微信机器人-读经助手 帮助实现如下功能：</p><ul><li>定时在微信群中发送文章链接</li><li>基于群成员的聊天信息(已读、完成) 等，自动进行统计打卡</li></ul><p>感谢 <a href="https://wechaty.js.org/" target="_blank" rel="noopener noreferrer">Wechaty</a> ，基于 Wechaty SDK，笔者通过一个晚上，就实现了 读经助手 的上述核心诉求，从此解放双手。目前 读经助手 在投入到 6 个微信群中使用，最长服务时长达 2 个月，服务人数 200+。(不敢主动推广，原因后面会讲)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三产品功能特性">三、产品功能特性<a href="#三产品功能特性" class="hash-link" aria-label="三、产品功能特性的直接链接" title="三、产品功能特性的直接链接">​</a></h2><p>核心功能仅用了一个晚上就实现了，但笔者大概花了 一个月(代码量 3000 行左右 ts 代码) 的时间来丰富 读经助手 的周边功能。完整功能大致分为以下几类：</p><ul><li>定时文章推送 (支持了多种基督教刊物)</li><li>群成员打卡 (基于群成员聊天，统计打卡人数、汇总生成 excel 表格)</li><li>获取文章链接 (获取多种基督教刊物的在线链接)</li><li>搜索文章内容 (搜索基督教刊物的内容)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="功能简介">功能简介<a href="#功能简介" class="hash-link" aria-label="功能简介的直接链接" title="功能简介的直接链接">​</a></h3><p><img loading="lazy" alt="image" src="/assets/images/03-01-19c3ebf7b7e83a24c23b8ea3166eca43.webp" width="1168" height="288" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="更多功能">更多功能<a href="#更多功能" class="hash-link" aria-label="更多功能的直接链接" title="更多功能的直接链接">​</a></h3><p><img loading="lazy" alt="image" src="/assets/images/03-02-2dd35c589304371a331b5bdd5af8e124.webp" width="1874" height="622" class="img_ev3q"></p><p><a target="_blank" href="/assets/files/03-03-2a7fbe212f0b20f09dc75d5f97819a7f.webp">更多功能长图</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="文章推送">文章推送<a href="#文章推送" class="hash-link" aria-label="文章推送的直接链接" title="文章推送的直接链接">​</a></h3><p><img loading="lazy" alt="image" src="/assets/images/03-04-ff7ea506c363ee645e6e611c446fbc2e.webp" width="1628" height="520" class="img_ev3q"></p><p><img loading="lazy" alt="image" src="/assets/images/03-05-3d083f83baf514250f7a35cce48bad3c.webp" width="1000" height="547" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="打卡统计">打卡统计<a href="#打卡统计" class="hash-link" aria-label="打卡统计的直接链接" title="打卡统计的直接链接">​</a></h3><p><img loading="lazy" alt="image" src="/assets/images/03-06-0de8c007cc291e9bc8aa42d4b1e1aa7f.webp" width="1706" height="1104" class="img_ev3q"></p><p><img loading="lazy" alt="image" src="/assets/images/03-07-654488a1a01420bc77e733f367757e5c.webp" width="1220" height="234" class="img_ev3q"></p><p><img loading="lazy" alt="image" src="/assets/images/03-08-55e745d6a926aa837bd2f2819385a0f5.webp" width="1302" height="452" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="搜文章内容">搜文章内容<a href="#搜文章内容" class="hash-link" aria-label="搜文章内容的直接链接" title="搜文章内容的直接链接">​</a></h3><p><img loading="lazy" alt="image" src="/assets/images/03-09-9837c6fc9cca9db1b027e601a6ccee32.webp" width="1444" height="672" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四技术实现">四、技术实现<a href="#四技术实现" class="hash-link" aria-label="四、技术实现的直接链接" title="四、技术实现的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wechaty">Wechaty<a href="#wechaty" class="hash-link" aria-label="Wechaty的直接链接" title="Wechaty的直接链接">​</a></h3><p>目前来看，上手成本最低的应该是只用 <a href="https://wechaty.js.org/docs/puppet-services/" target="_blank" rel="noopener noreferrer">puppet-services</a>，我使用的 token 提供商是 <a href="https://wechaty.js.org/docs/puppet-services/paimon" target="_blank" rel="noopener noreferrer">Paimon</a>, 注册手机号，即可获取 7 天 token。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="部署方案">部署方案<a href="#部署方案" class="hash-link" aria-label="部署方案的直接链接" title="部署方案的直接链接">​</a></h3><p>一共经历了如下几个部署方案：</p><ul><li><ol><li>闲置电脑部署 wechaty 应用 +  数据库(AWS dynamodb 香港节点)，使用 dynamodb 是因为这是亚马逊云的免费数据库产品，想白嫖。</li></ol></li><li><ol start="2"><li> 阿里云轻量应用服务器(1C 2G 40G-SSD 杭州节点) 部署 wechaty 应用 +  数据库(AWS dynamodb 香港节点)， 阿里云服务器是 98 元每年(新用户活动价)，可连续买三年。但阿里云杭州节点 连 亚马逊香港节点，延迟有时候会有 几十秒。尝试过阿里云香港节点，数据库请求是快了，但发送给 puppet-services 的请求有时会有几秒的延迟。</li></ol></li><li><ol start="3"><li>阿里云部署 wechaty 应用 + 数据库换成服务器自带的 mongodb。 这样访问 puppet-services、数据库都非常快。 由于两种数据库都是文档型，迁移的成本还不算太高，大概花了一天时间做数据库迁移+适配层代码。</li></ol></li></ul><p>由于需要做内容搜索，所以也在阿里云服务器上部署了 ElasticSearch。阿里云 98 一年真香。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="实现思路">实现思路<a href="#实现思路" class="hash-link" aria-label="实现思路的直接链接" title="实现思路的直接链接">​</a></h3><p>代码开源在该<a href="https://github.com/kkdev163/wechaty-bible-robot" target="_blank" rel="noopener noreferrer">仓库</a>，感兴趣的可以参考下，本节主要介绍下目录结构</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">├── README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── deploy.sh  部署脚本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── dev.sh  开发环境脚本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── ecosystem.config.js pm2进程管理配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── nodemon.json 本地开发配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── package-lock.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── package.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── prod.sh 生产环境脚本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── index.ts  wechaty 主入口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── actions  actions 命令的实现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── _7cthSchedule.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── bibleSchedule.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── commit.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── index.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── pushSchedule.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── remind.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── search.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── smdjSchedule.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   └── static.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── bible  圣经相关的资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── _7cth.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── plan.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── shareRes.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   └── smdj.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── constants.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── controller 放开 http 服务的控制器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── index.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── proxy.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── search.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── setting.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   └── utils.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── ddb 数据库相关</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── commands</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── index.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── mongoDb.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── schema.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   └── syncModels.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── handleMessage.ts 消息处理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── http.ts http 服务器入口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   └── index.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── schedule.ts 定时任务入口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> http 服务对应的 </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── esClient.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   ├── search.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       │   └── setting.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       └── util 工具函数库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── bibleData.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── bibleUtils.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── canvas.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── devUtils.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── drawBible.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── drawUtils.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── formatUtils.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── index.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── smdj-es-doc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── smdjStats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── smdjUtils.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── songUtils.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           ├── timeUtils.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           └── wxUtils.ts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="五心得体会">五、心得体会<a href="#五心得体会" class="hash-link" aria-label="五、心得体会的直接链接" title="五、心得体会的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="第一次为自己写代码">第一次为自己写代码<a href="#第一次为自己写代码" class="hash-link" aria-label="第一次为自己写代码的直接链接" title="第一次为自己写代码的直接链接">​</a></h3><p> 笔者之前大部分写的代码都是为了学习、工作(赚钱)。这次是 为了解放自己的双手、便利身边朋友 而写代码，心态从赚钱变成了奉献。发现自己又重新找回了，写程序的激情 和 热情，在开发读经机器人期间，有好几次通宵的经历，而且功能上线后，及时的反馈 和自我满足感是很让人愉悦的。</p><p>这也让我意识到，写代码不仅仅是一种工作，而确确实实是一项实用的生活技能、特长。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="微信侧风险">微信侧风险<a href="#微信侧风险" class="hash-link" aria-label="微信侧风险的直接链接" title="微信侧风险的直接链接">​</a></h3><p>开发阶段，有次把机器人号，从测试群中主动踢出，发现 Provider Service 抛出了一个 Error，为了复现这个异常，我重复多次把这个号从测试群中踢出。然后过了一段时间，就收到了 微信风控通知，提示该号被 多人投诉、有骚扰用户的行为。 所以大家尽量不要将 机器人踢出群，最好采用主动退出的方式，以免被微信风控。</p><p>换了新的微信号后，大概服务了 2 个月不到，发现被微信主动踢下线了，再次登录提示使用了 微信外挂、非官方客户端或模拟器。不清楚是, provider service 的方案，被大批检测出，还是仅仅是 笔者的微信号，被投诉导致。。
<img loading="lazy" alt="image" src="/assets/images/04-01-a2c8b8d2f3a5d0efacb7135bc7b23311.webp" width="1080" height="2412" class="img_ev3q"></p><p>笔者开发机器人的初衷是希望解放人力，其实越多的微信群使用(免费使用)，对我来说，开发机器人的价值越高。但由于存在微信封号风险，是目前笔者不敢主动推广，仅靠群成员的口口相传。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-8-原则">2 8 原则<a href="#2-8-原则" class="hash-link" aria-label="2 8 原则的直接链接" title="2 8 原则的直接链接">​</a></h3><p>如上文提到的核心功能，笔者 1 个晚上就实现了，剩下的时间都在丰富七七八八的周边功能。但说实话，这些周边功能，都是我个人在使用，频率非常低，但却占据了我整体开发的 80% 以上时间。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="交互友好性">交互友好性<a href="#交互友好性" class="hash-link" aria-label="交互友好性的直接链接" title="交互友好性的直接链接">​</a></h3><p>由于读经机器人有部分功能是需要输出长段的文字，考虑到阅读的友好性，防止老年机大段文字刷屏，读经机器人使用了 node-canvas 渲染引擎，并实现了简单的文字排版，将大段文字通过图片的方式发送给用户。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="便利性与通用性">便利性与通用性<a href="#便利性与通用性" class="hash-link" aria-label="便利性与通用性的直接链接" title="便利性与通用性的直接链接">​</a></h3><p>为了使功能更加通用性，部分功能的开发，常常是站在程序员的视角出发，提供出多个参数化的配置，但这却加大了使用者的认知成本。比如 读经助手 提供了如下命令</p><p><code>@读经助手  创建读经计划 创世记1~玛拉基书4 90天</code></p><p>该命令中包含了如下几个参数「起始书卷、起始章节、结束书卷、结束章节、阅读天数」，更便利的做法是包装成如下指令</p><p><code>@读经助手 创建读经计划 旧约 90天</code></p><p>另外笔者还尝试过开发了一个 H5 页面，当群成员输入</p><p><code>@读经助手 群设置</code></p><p>返回该群设置的 H5 页面链接，这样通过 H5 页面的方式进行配置，虽然可以方便使用者。但同时也引入了安全性问题：任意一名群成员都能打开 H5 页面，他可以随意 删除、改变 群配置。如果要防止该问题，就需要额外开发 登录、鉴权。相比而言，使用群聊输入命令，是处于 全群监督下，不会有人进行乱操作。。所以虽然开发了 H5 设置页面，但没有对用户开发。</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/wechaty、robot">wechaty、robot</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/inner-glance-of-padlocal"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">Wechaty-puppet-padlocal 实现初探</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/elasticsearch-basic"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">ES(ElasticSearch) 搜索基本概念简介</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一前言" class="table-of-contents__link toc-highlight">一、前言</a></li><li><a href="#二开发意图" class="table-of-contents__link toc-highlight">二、开发意图</a></li><li><a href="#三产品功能特性" class="table-of-contents__link toc-highlight">三、产品功能特性</a><ul><li><a href="#功能简介" class="table-of-contents__link toc-highlight">功能简介</a></li><li><a href="#更多功能" class="table-of-contents__link toc-highlight">更多功能</a></li><li><a href="#文章推送" class="table-of-contents__link toc-highlight">文章推送</a></li><li><a href="#打卡统计" class="table-of-contents__link toc-highlight">打卡统计</a></li><li><a href="#搜文章内容" class="table-of-contents__link toc-highlight">搜文章内容</a></li></ul></li><li><a href="#四技术实现" class="table-of-contents__link toc-highlight">四、技术实现</a><ul><li><a href="#wechaty" class="table-of-contents__link toc-highlight">Wechaty</a></li><li><a href="#部署方案" class="table-of-contents__link toc-highlight">部署方案</a></li><li><a href="#实现思路" class="table-of-contents__link toc-highlight">实现思路</a></li></ul></li><li><a href="#五心得体会" class="table-of-contents__link toc-highlight">五、心得体会</a><ul><li><a href="#第一次为自己写代码" class="table-of-contents__link toc-highlight">第一次为自己写代码</a></li><li><a href="#微信侧风险" class="table-of-contents__link toc-highlight">微信侧风险</a></li><li><a href="#2-8-原则" class="table-of-contents__link toc-highlight">2 8 原则</a></li><li><a href="#交互友好性" class="table-of-contents__link toc-highlight">交互友好性</a></li><li><a href="#便利性与通用性" class="table-of-contents__link toc-highlight">便利性与通用性</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 kkdev163. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.59883482.js"></script>
<script src="/assets/js/main.03c6f4a0.js"></script>
</body>
</html>